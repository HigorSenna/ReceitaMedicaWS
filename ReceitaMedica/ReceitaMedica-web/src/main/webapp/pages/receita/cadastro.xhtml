<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	template="../template/template.xhtml">

	<ui:define name="corpoPagina">
		<div id="divCadastroMaterial">
			<p:messages id="message" showDetail="true" closable="true" />

			<h1 style="width: 100%; text-align: center;">Cadastro de Receita Médica</h1>

			<h:form prependId="false" id="formularioCadastroReceitaMedica">
	
				<br /> <br /> <br />
	
				<div class="form-group row">
					<label for="cpfPaciente" class="col-xs-2 col-form-label">Cpf Paciente</label>
					<div class="col-xs-10">
						<p:inputText class="form-control" value="#{cadastroReceitaController.cadastroReceitaVM.paciente.cpfPaciente}"
							id="cpfPaciente" style="width: 50%;" maxlength="11">
								<p:ajax event="blur" listener="#{cadastroReceitaController.getPacienteCPF()}" update="cpfPaciente nomePaciente"/>
						</p:inputText>
							<h:outputLabel id="nomePaciente" value="#{cadastroReceitaController.cadastroReceitaVM.paciente.nmPaciente}" />
					</div>
				</div>
				<div class="form-group row">
					<label for="crmMedico" class="col-xs-2 col-form-label">CRM Médico</label>
					<div class="col-xs-10">
						<p:inputText class="form-control"
							value="#{cadastroReceitaController.cadastroReceitaVM.medico.crmMedico}" id="crmMedico" style="width: 50%;" maxlength="11">
								<p:ajax event="blur" listener="#{cadastroReceitaController.getMedicoCRM()}" update="crmMedico nomeMedico"/>
						</p:inputText>
						
						<h:outputLabel id="nomeMedico" value="#{cadastroReceitaController.cadastroReceitaVM.medico.nmMedico}" />
					</div>
				</div>
				
				<div class="form-group row">
					<label for="numReceitaItem" class="col-xs-2 col-form-label">Numero Receita</label>
					<div class="col-xs-10">
						<h:inputText class="form-control" value="#{cadastroReceitaController.cadastroReceitaVM.receitaMedica.numReceita}" id="numReceitaItem" 
							style="width: 50%;" maxlength="11" disabled="true">

						</h:inputText>
					</div>
				</div>
			</h:form>
			
			<h:form id="formularioMedicamentos" prependId="false">
			
				<div>
					<br/>
					
					<div class="form-group row">
						<label for="instrucaoItemReceita" class="col-xs-2 col-form-label">Instrucao</label>
						<div class="col-xs-10">
							<h:inputTextarea class="form-control" value="#{cadastroReceitaController.cadastroReceitaVM.itemReceita.instrucao}"
								id="instrucaoItemReceita" style="width: 50%;" maxlength="11" required="true"/>
						</div>
					</div>
					
					<div class="form-group row">
						<label for="nomeReceita" class="col-xs-2 col-form-label">Nome Receita</label>
						<div class="col-xs-10">
							<h:inputText class="form-control" value="#{cadastroReceitaController.cadastroReceitaVM.itemReceita.nmReceita}"
								id="nomeReceita" style="width: 50%;" maxlength="11" required="true"/>
						</div>
					</div>
					
					<div class="form-group row">
						<label for="usoReceita" class="col-xs-2 col-form-label">USO</label>
						<div class="col-xs-10">
							<h:inputText class="form-control" value="#{cadastroReceitaController.cadastroReceitaVM.itemReceita.uso}"
								id="usoReceita" style="width: 50%;" maxlength="11" required="true"/>
						</div>
					</div>
					
					<div class="form-group row">
						<label for="contraIndicacao" class="col-xs-2 col-form-label">Contra-Indicação</label>
						<div class="col-xs-10">
							<h:inputText class="form-control" value="#{cadastroReceitaController.cadastroReceitaVM.itemReceita.contraIndicacao}"
								id="contraIndicacao" style="width: 50%;" maxlength="11" required="true"/>
						</div>
					</div>
					
					<div class="form-group row">
						<label for="regAnvisa" class="col-xs-2 col-form-label">Nº Anvisa</label>
						<div class="col-xs-10">
							<h:inputText class="form-control" value="#{cadastroReceitaController.cadastroReceitaVM.itemReceita.regAnvisa}"
								id="regAnvisa" style="width: 50%;" maxlength="11" required="true"/>
						</div>
					</div>
				</div>
				<p:commandButton class="btn btn-info" value="Adicionar Medicamento" id="botaoAddMedicamento" action="#{cadastroReceitaController.addItemReceita()}" style="margin-left:43%"
				  update="medicamentos message formularioMedicamentos" process="formularioMedicamentos"/>
			</h:form>
				
				<br/>
				

				<div class="table table-hover">
					<p:dataTable id="medicamentos" style="margin-bottom:0;margin-top: 5%;margin-left:0%;width:60%;text-align:center;" paginator="true" 
						rows="10" lazy="false" var="item" value="#{cadastroReceitaController.cadastroReceitaVM.itensReceita}"						
						
						rowsPerPageTemplate="5, 10, 15" paginatorPosition="bottom">
						
						<f:facet name="header">
							Tabela de Medicamentos
						</f:facet>
<!-- 						<p:column headerText="Data da compra"> -->
<!-- 							<h:outputText value=""> -->
<!-- 								<f:convertDateTime pattern="dd/MM/yyyy" locale="pt,BR" /> -->
<!-- 							</h:outputText> -->
<!-- 						</p:column> -->
						<p:column headerText="Instrução">
							<h:outputText value="#{item.instrucao}" />
						</p:column>

						<p:column headerText="Nome da Receita">
							<h:outputText value="#{item.nmReceita}" />
						</p:column>

						<p:column headerText="Uso">
							<h:outputText value="#{item.uso}" />
						</p:column>

						<p:column headerText="Contra-Indicação">
							<h:outputText value="#{item.contraIndicacao}" />
						</p:column>
						
						<p:column headerText="Nº Anvisa">
							<h:outputText value="#{item.regAnvisa}" />
						</p:column>
						
					</p:dataTable>
				</div>
				<h:form id="formBotaoCadastrar" prependId="false">
					<p:commandButton class="btn btn-success" value="Cadastrar" id="botaoCadastroReceita" action="#{cadastroReceitaController.salvar()}" />
				</h:form>
		</div>
			
	</ui:define>
</ui:composition>